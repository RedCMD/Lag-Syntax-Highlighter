name: buildwasm

on:
  workflow_dispatch:
  
jobs:
  release:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - run: git clone https://github.com/emscripten-core/emsdk.git
      - run: cd emsdk && ./emsdk install latest && ./emsdk activate latest
      - run: cd emsdk && cat ./emsdk_env.sh && source ./emsdk_env.sh
      - run: cd ../ && mkdir tree-sitter-your_language && cd tree-sitter-your_language
      - run: npm install tree-sitter-cli
      - run: echo "module.exports = grammar({ name:'your_language', rules:{ source_file:$ => 'hello' }});" > example-file
      - run: cd node_modules/tree-sitter-cli/
      - run: ls -a
      - run: ./node_modules/tree-sitter-cli/tree-sitter
      - run: node_modules/tree-sitter-cli/tree-sitter generate
      - run: node_modules/tree-sitter-cli/tree-sitter parse example-file
